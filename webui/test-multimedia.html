<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multimedia Rendering Test</title>
    <link rel="stylesheet" href="css/enhanced-multimedia-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f2f5;
            margin: 0;
            padding: 20px;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        .test-section {
            margin: 30px 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        h1, h2 {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üé® Pareng Boyong Enhanced Multimedia Test</h1>
        
        <div class="test-section">
            <h2>Image Rendering Test</h2>
            <div id="image-test-container"></div>
        </div>
        
        <div class="test-section">
            <h2>Video Rendering Test</h2>
            <div id="video-test-container"></div>
        </div>
        
        <div class="test-section">
            <h2>Audio Rendering Test</h2>
            <div id="audio-test-container"></div>
        </div>
        
        <div class="test-section">
            <h2>Mixed Media Test</h2>
            <div id="mixed-test-container"></div>
        </div>
    </div>

    <script type="module">
        import { convertMultimediaTags, createMediaPlayer, enhanceImageRendering } from './js/enhanced-multimedia-renderer.js';
        
        // Test image rendering
        async function testImageRendering() {
            try {
                const response = await fetch('http://localhost:8091/generate/image', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: 'a small colorful test image',
                        width: 300,
                        height: 200
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const imageContent = `<image>${data.image_base64}</image>`;
                    const processedContent = convertMultimediaTags(imageContent);
                    
                    document.getElementById('image-test-container').innerHTML = processedContent;
                    
                    // Enhance the image
                    const images = document.querySelectorAll('#image-test-container img.multimedia-image');
                    images.forEach(enhanceImageRendering);
                } else {
                    document.getElementById('image-test-container').innerHTML = 
                        '<p style="color: orange;">‚ö†Ô∏è Image service not available (check if Pollinations container is running)</p>';
                }
            } catch (error) {
                document.getElementById('image-test-container').innerHTML = 
                    '<p style="color: red;">‚ùå Error testing image rendering: ' + error.message + '</p>';
            }
        }
        
        // Test video rendering (placeholder)
        function testVideoRendering() {
            const videoContent = `<video>UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zPLNeSsFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zPLNeSsFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zO</video>`;
            const processedContent = convertMultimediaTags(videoContent);
            document.getElementById('video-test-container').innerHTML = processedContent + 
                '<p><em>Note: This is a placeholder video test. Real video will be generated by Wan2GP service.</em></p>';
        }
        
        // Test audio rendering (placeholder)
        function testAudioRendering() {
            const audioContent = `<audio>UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zPLNeSsFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zPLNeSsFJHfH8N2QQAoUXrTp66hVFApFn+D3yXkpBSl+zO</audio>`;
            const processedContent = convertMultimediaTags(audioContent);
            document.getElementById('audio-test-container').innerHTML = processedContent + 
                '<p><em>Note: This is a placeholder audio test. Real audio will be generated by music/voice services.</em></p>';
        }
        
        // Test mixed media
        function testMixedMedia() {
            const mixedContent = `
                <h3>Mixed Media Content Test</h3>
                <p>This is a paragraph with an inline image: <image>iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==</image> and some text after.</p>
                <p>Here's a video element:</p>
                <video>UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a</video>
                <p>And an audio element:</p>
                <audio>UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a</audio>
            `;
            const processedContent = convertMultimediaTags(mixedContent);
            document.getElementById('mixed-test-container').innerHTML = processedContent;
        }
        
        // Run tests
        window.addEventListener('load', () => {
            testImageRendering();
            testVideoRendering();
            testAudioRendering();
            testMixedMedia();
        });
    </script>
</body>
</html>